\chapter{任务清单}

%\pagestyle{empty}
\todo[inline]{The original todo note withouth changed colours.\newline Here's another line.}
\lipsum[11]\unsure{Is this correct?}\unsure{I'm unsure about also!}
\lipsum[11]\change{Change this!}
\lipsum[11]\info{This can help me in chapter seven!}
\lipsum[11]\improvement{This really needs to be improved!\newline\newline What was I thinking?!}
\lipsum[11]
\thiswillnotshow{This is hidden since option `disable' is chosen!}
\improvement[inline]{The following section needs to be rewritten!}
\lipsum[11]
%\newpage

\section{原生卷}

\begin{tcolorbox}
\begin{compactenum}
    \item 存储池
    \item Mapping
    \item 数据恢复性能
    \item Redis Cache
    \item 快照树
    \item 精简配置，快照对性能的影响
    \item 故障下的性能及其抖动
    \item \hl{async sqlite} [DONE]
    \item \hl{batch sqlite}
    \item Allocate的性能
    \item 单卷快照的数量
    \item VAAI
    \item SSD Cache
    \item 异步远程复制
    \item FC (+VAAI)
\end{compactenum}
\end{tcolorbox}

\section{关键特性和过程}

\begin{compactenum}
    \item flush, load and recovery
    \item 保护模式 safe mode
    \item 存储分层
    \item 命令行工具，扩展卷和快照相关操作到LSV
\end{compactenum}

\section{兼容性}

\begin{compactenum}
    \item 版本演进
\end{compactenum}

\section{Pool}

\begin{compactenum}
    \item Resource Pool
\end{compactenum}

\section{Volume}

\begin{compactenum}
    \item new format: row2
    \item new format: lsv
    \item vol max size 256T+
    \item vol resize?
    \item all zero's chunk
\end{compactenum}

\section{快照}

\begin{compactenum}
    \item 支持60000+快照
    \item consistency group
    \item 每个snap的大小等信息
    \item snap大小对GC策略的影响
\end{compactenum}

\section{一致性/正确性}

\begin{tcolorbox}
\begin{compactenum}
    \item 底层数据检验工具(chunk0, volume, log/gc, bitmap, wal, rcache)
    \item 内置质量，各模块添加自校验机制，方便诊断数据正确性问题(assert + log + test)
    \item 加强断言：pre和post条件，变量变化规则，不变式，基本假设等
    \item 日志用tag/keywork和timeline，以便于跟踪一个对象的变化历史，用一个或多个维度贯穿起来，用于辅助诊断
    \item 增加CHUNK\_HISTORY，以时间线方式，跟踪记录CHUNK变化的生命周期
\end{compactenum}
\end{tcolorbox}

\section{性能}

性能是负载和资源的函数, $P=F(W, R)$。

\begin{tcolorbox}
\begin{compactenum}
    \item 创建卷时，rcache分配了4096M的SSD cache，可以延迟分配
    \item \textcolor{red}{rcache 顺序IO随机化问题}
    \item wbuf 顺序IO随机化问题
    \item 系统启动时间
    \item 预填充lich chunk
    \item GC策略和算法
    \item 统计基础操作的开销，作为性能分析的基础
\end{compactenum}
\end{tcolorbox}

\section{负载}

\begin{tcolorbox}
\begin{compactenum}
    \item IO队列深度
    \item IO平均大小
    \item IO读写大小
\end{compactenum}
\end{tcolorbox}

\section{资源}

\begin{tcolorbox}
\begin{compactitem}
    \item 内存使用量过大
    \item 内存泄漏
    \item 磁盘利用率不足
    \item 网络带宽：瓶颈或利用率不足
    \item 中断
    \item soft lock up?
\end{compactitem}
\end{tcolorbox}

\section{故障处理}

\begin{compactenum}
    \item \change{故障域，不能中断IO}
    \item 节点间负载均衡(<20\%)
\end{compactenum}

\section{Misc}

\begin{tcolorbox}
\begin{compactitem}
    \item FC
    \item Remote copy
    \item SSD cache
    \item EC
    \item 有效容量的比例
    \item 热插拔
    \item 磁盘漫游
    \item 在线扩容
    \item 滚动升级
\end{compactitem}
\end{tcolorbox}

\section{DONE}

\begin{compactenum}
    \item VAAI [+xcopy]
\end{compactenum}
