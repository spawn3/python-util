\chapter{对象模型}

集群

节点，存储介质

资源池，保护域，故障域

pool, volume, snapshot等基本概念。

\section{Resource Pool}

不应该出现在IQN里面。

保护域是物理节点的划分，资源池是存储介质的划分。每块盘只能出现在一个资源池里。

不同资源池之间，卷的copy和migration。

卷和资源池的关系，资源池的CRUD。

diskmap

chunkid到磁盘物理位置有两级映射：chunk的副本节点列表，节点内chunkid到物理地址的映射。

在为卷分配chunk的时候，需要确定各个副本的物理存储位置。当前实现是返回不同副本的节点列表。
如果指定了资源池，就需要在资源池所在的节点范围内进行分配。

资源池内，要满足故障域规则(\ref{rule:faultset})
都需遵循这些规则。

CRC协作类：
\begin{itemize}
    \item node and disk
    \item volume
    \item pool
    \item protection domain
    \item fault set
\end{itemize}

资源池是disk的集合，与节点无关。但disk所在的节点构成资源池的节点列表，故障域如果定义在节点级。

资源池下，可以创建pool和volume。

资源池和pool是什么关系？一对一，一对多，多对多。

资源池和保护域什么关系？

资源池包含故障域。

\section{Fault Set}

资源池内，要满足故障域规则：一个chunk的不同副本，分布在不同的故障域内。\label{rule:faultset}

在初次分配，再平衡和恢复等过程中，都需遵循这些规则。

\section{Pool}
\section{Volume}
\section{Snapshot}
\section{Volume Group}
